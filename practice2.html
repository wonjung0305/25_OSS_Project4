<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      ul li{
        background-color: aquamarine;
        height: 28px;
      }

      li{
        list-style: none;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>fetch() 및 비동기 통신 연습</h1>

    <button id="load_btn">Get data</button>
    <ul id="user_list"></ul>
  </body>
</html>

<script>
  const list = document.getElementById("user_list");

  function getList() {
    fetch("https://jsonplaceholder.typicode.com/users") // promise 객체로 반환
      .then((response) => response.json()) // fetch가 성공 -> 응답 객체가 들어옴, response.json()은 JSON -> JS 객체/배열로 바꿔줌
      .then((data) => {
        const userList = document.getElementById("user_list");
        userList.innerText=""; // 기존에 있던 내용 초기화
        data.forEach(user => {
          const li = document.createElement("li"); // 새로운 li 생성
          li.textContent = `${user.name} (${user.email})`; // 글자를 직접 넣음
          userList.appendChild(li); // 데이터가 담긴 li를 ul에 추가
        });
      }).catch(error => console.error("에러 발생: ", error));
  }

  document.getElementById("load_btn").addEventListener("click", getList);
</script>
<!-- 
fetch(url)은 서버에 요청을 보냄 -> 결과는 Promise 형태로 옴
  이때 그 Promise가 성공하면 response 객체를 줌

  response에는 텍스트(JSON 문자열)형태로 정보가 있음
  response.json()은 자바스크립트 객체/배열로 바꿔줌

  1. then() 문법
    : then( 매개 변수 => { 실행 코드})
    : 매개 변수는 Promise가 성공했을 때 넘겨주는 값을 담는 변수의 이름
    : 실행 코드는 매개변수로 하고 싶은 동작을 기술
      : 화살표 함수 문법에서, 중괄호를 쓰면 return을 명시해야 함
      : "만약 한 줄이고, 그게 리턴 값이면 괄호와 return 생략 가능"
      : return은 다음 then으로 값을 넘길 때 필요 (그냥 출력 같은 경우는 필요 없음)

-->
